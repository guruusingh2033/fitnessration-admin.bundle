{"version":3,"sources":["meteor://ðŸ’»app/imports/api/addOns.js","meteor://ðŸ’»app/imports/api/anomalyTriggers.js","meteor://ðŸ’»app/imports/api/blocks.js","meteor://ðŸ’»app/imports/api/bundleTypes.js","meteor://ðŸ’»app/imports/api/deleted.js","meteor://ðŸ’»app/imports/api/fulfillmentSettings.js","meteor://ðŸ’»app/imports/api/ingredients.js","meteor://ðŸ’»app/imports/api/locationSurcharges.js","meteor://ðŸ’»app/imports/api/mealPlans.js","meteor://ðŸ’»app/imports/api/mealStock.js","meteor://ðŸ’»app/imports/api/meals.js","meteor://ðŸ’»app/imports/api/orders.js","meteor://ðŸ’»app/imports/api/partners.js","meteor://ðŸ’»app/imports/api/portions.js","meteor://ðŸ’»app/imports/api/promotions.js","meteor://ðŸ’»app/imports/api/sides.js","meteor://ðŸ’»app/imports/api/stockCache.js","meteor://ðŸ’»app/imports/api/surveys.js","meteor://ðŸ’»app/imports/api/timeSlots.js","meteor://ðŸ’»app/imports/api/users.js","meteor://ðŸ’»app/imports/StockCalculator.js","meteor://ðŸ’»app/imports/date.ts","meteor://ðŸ’»app/imports/helpers.js","meteor://ðŸ’»app/server/main.js"],"names":[],"mappings":";;;;;;;;AAAA,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,SAAS,IAAI,MAAM,UAAV,CAAqB,QAArB,EAA+B,EAAC,cAAc,OAAf,EAA/B,CAAf;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,QAAf,EAAyB,YAAW;AACnC,WAAO,OAAO,IAAP,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,kBAAkB,IAAI,MAAM,UAAV,CAAqB,iBAArB,EAAwC,EAAC,cAAc,OAAf,EAAxC,CAAxB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,iBAAf,EAAkC,YAAW;AAC3C,WAAO,gBAAgB,IAAhB,EAAP;AACD,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,SAAS,IAAI,MAAM,UAAV,CAAqB,QAArB,EAA+B,EAAC,cAAc,OAAf,EAA/B,CAAf;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,QAAf,EAAyB,YAAW;AACnC,WAAO,OAAO,IAAP,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,cAAc,IAAI,MAAM,UAAV,CAAqB,aAArB,EAAoC,EAAC,cAAc,OAAf,EAApC,CAApB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,aAAf,EAA8B,YAAW;AACxC,WAAO,YAAY,IAAZ,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,UAAU,IAAI,MAAM,UAAV,CAAqB,SAArB,EAAgC,EAAC,cAAc,OAAf,EAAhC,CAAhB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,SAAf,EAA0B,YAAW;AACpC,WAAO,QAAQ,IAAR,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,sBAAsB,IAAI,MAAM,UAAV,CAAqB,qBAArB,EAA4C,EAAC,cAAc,OAAf,EAA5C,CAA5B;AACP,oBAAoB,YAApB,CAAiC,IAAI,YAAJ,CAAiB;AACjD,cAAa,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EADoC;AAEjD,2BAA0B,EAAE,MAAM,IAAR,EAAc,UAAU,IAAxB,EAFuB;;AAIjD,wBAAuB,EAAE,MAAM,MAAR,EAJ0B;AAKjD,qCAAoC,EAAE,MAAM,IAAR,EAAc,UAAU,IAAxB,EALa;;AAOjD,UAAS,EAAE,MAAM,MAAR,EAPwC;AAQjD,uBAAsB,EAAE,MAAM,IAAR,EAAc,UAAU,IAAxB,EAR2B;;AAUjD,aAAY,EAAE,MAAM,MAAR,EAVqC;AAWjD,0BAAyB,EAAE,MAAM,IAAR,EAAc,UAAU,IAAxB;AAXwB,CAAjB,CAAjC,EAYI,EAAC,WAAU,IAAX,EAZJ;;AAcA,IAAI,OAAO,QAAX,EAAqB;AACnB,QAAO,OAAP,CAAe,qBAAf,EAAsC,YAAM;AAC3C,SAAO,oBAAoB,IAApB,EAAP;AACA,EAFD;AAGD,0H;;;;;;;;;;;ACrBD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,cAAc,IAAI,MAAM,UAAV,CAAqB,aAArB,EAAoC,EAAC,cAAc,OAAf,EAApC,CAApB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,aAAf,EAA8B,YAAW;AACxC,WAAO,YAAY,IAAZ,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,qBAAqB,IAAI,MAAM,UAAV,CAAqB,oBAArB,EAA2C,EAAC,cAAc,OAAf,EAA3C,CAA3B;AACP,mBAAmB,YAAnB,CAAgC,IAAI,YAAJ,CAAiB;AAChD,aAAW,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EADqC;AAEhD,gBAAc,EAAE,MAAM,MAAR;AAFkC,CAAjB,CAAhC,EAGI,EAAC,WAAU,IAAX,EAHJ;;AAKA,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,oBAAf,EAAqC,YAAW;AAC/C,WAAO,mBAAmB,IAAnB,EAAP;AACA,GAFD;AAGD,0H;;;;;;;;;;;ACZD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,YAAY,IAAI,MAAM,UAAV,CAAqB,WAArB,EAAkC,EAAC,cAAc,OAAf,EAAlC,CAAlB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,WAAf,EAA4B,YAAW;AACtC,WAAO,UAAU,IAAV,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;AACA,SAAS,UAAT,QAA2B,YAA3B;;AAEA,OAAO,IAAM,YAAY,IAAI,MAAM,UAAV,CAAqB,WAArB,EAAkC,EAAC,cAAc,OAAf,EAAlC,CAAlB;AACP,UAAU,YAAV,CAAuB,IAAI,YAAJ,CAAiB;AACvC,UAAS,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAD8B;AAEvC,aAAY,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAF2B;AAGvC,UAAS,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAH8B;AAIvC,SAAQ,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAJ+B;AAKvC,QAAO,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EALgC;AAMvC,WAAU,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAN6B;AAOvC,QAAO,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAPgC;;AASvC,cAAa,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAAgC,UAAU,IAA1C,EAT0B;AAUvC,OAAM,EAAE,MAAM,MAAM,QAAd,EAViC;AAWvC,OAAM,EAAE,MAAM,MAAR;AAXiC,CAAjB,CAAvB,EAYI,EAAC,WAAU,IAAX,EAZJ;;AAcA,IAAI,OAAO,QAAX,EAAqB;AACnB,QAAO,OAAP,CAAe,WAAf,EAA4B,YAAW;AACtC,SAAO,UAAU,IAAV,EAAP;AACA,EAFD;;AAIA,QAAO,OAAP,CAAe,mBAAf,EAAoC,UAAS,OAAT,EAAkB,OAAlB,EAA2B;AAC9D,SAAO,UAAU,IAAV,CAAe,EAAC,MAAK,EAAC,MAAK,WAAW,OAAX,CAAN,EAA2B,MAAK,WAAW,OAAX,CAAhC,EAAN,EAAf,CAAP;AACA,EAFD;AAGD,0H;;;;;;;;;;;AC1BD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,QAAQ,IAAI,MAAM,UAAV,CAAqB,OAArB,EAA8B,EAAC,cAAc,OAAf,EAA9B,CAAd;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,OAAf,EAAwB,YAAW;AAClC,WAAO,MAAM,IAAN,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,SAAS,IAAI,MAAM,UAAV,CAAqB,QAArB,EAA+B,EAAC,cAAc,OAAf,EAA/B,CAAf;AACP,SAAS,UAAT,QAA2B,YAA3B;;AAEA,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,QAAf,EAAyB,YAAW;AACnC,WAAO,OAAO,IAAP,EAAP;AACA,GAFD;;AAIA,SAAO,OAAP,CAAe,cAAf,EAA+B,UAAS,OAAT,EAAkB,OAAlB,EAA2B;AACzD,WAAO,OAAO,IAAP,CAAY,EAAC,wBAAuB,EAAC,MAAK,WAAW,OAAX,CAAN,EAA2B,KAAI,WAAW,OAAX,CAA/B,EAAxB,EAAZ,CAAP;AACA,GAFD;;AAIA,SAAO,OAAP,CAAe,WAAf,EAA4B,UAAS,EAAT,EAAa;AACxC,WAAO,OAAO,IAAP,CAAY,EAAZ,CAAP;AACA,GAFD;;AAIA,SAAO,OAAP,CAAe,cAAf,EAA+B,UAAS,EAAT,EAAa;AAC3C,WAAO,OAAO,IAAP,CAAY,EAAC,wBAAuB,EAAC,MAAK,WAAW,IAAI,IAAJ,EAAX,CAAN,EAAxB,EAAZ,CAAP;AACA,GAFD;AAGD,0H;;;;;;;;;;;ACrBD,SAAS,KAAT,QAAsB,cAAtB;AACA,OAAO,IAAM,WAAW,IAAI,MAAM,UAAV,CAAqB,UAArB,EAAiC,EAAC,cAAc,OAAf,EAAjC,CAAjB;AACP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,UAAf,EAA2B,YAAW;AACrC,WAAO,SAAS,IAAT,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACND,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,WAAW,IAAI,MAAM,UAAV,CAAqB,UAArB,EAAiC,EAAC,cAAc,OAAf,EAAjC,CAAjB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,UAAf,EAA2B,YAAW;AACrC,WAAO,SAAS,IAAT,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,aAAa,IAAI,MAAM,UAAV,CAAqB,YAArB,EAAmC,EAAC,cAAc,OAAf,EAAnC,CAAnB;AACP,WAAW,YAAX,CAAwB,IAAI,YAAJ,CAAiB;AACxC,OAAM,EAAC,MAAM,MAAP,EADkC;AAExC,cAAa,EAAE,MAAM,OAAR,EAAiB,cAAc,KAA/B,EAF2B;AAGxC,QAAO,EAAE,MAAM,MAAR,EAHiC;AAIxC,MAAK,EAAE,MAAM,MAAR,EAJmC;AAKxC,mBAAkB,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EALsB;AAMxC,iBAAgB,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EANwB;AAOxC,WAAU,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAP8B;AAQxC,gBAAe,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAAgC,SAAS,IAAzC,EARyB;AASxC,OAAM,EAAE,MAAM,MAAR,EATkC;AAUxC,YAAW,EAAE,MAAM,MAAR,EAV6B;AAWxC,MAAK,EAAE,MAAM,MAAR,EAXmC;AAYxC,aAAY,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAZ4B;;AAcxC,mBAAkB,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAdsB;AAexC,aAAY,EAAE,MAAM,MAAR,EAAgB,UAAU,IAA1B,EAf4B;;AAiBxC,WAAU,EAAE,MAAM,aAAa,KAAb,CAAmB,EAA3B,EAA+B,UAAU,IAAzC,EAA+C,cAAc,IAA7D,EAjB8B;AAkBxC,UAAS,EAAE,MAAM,aAAa,KAAb,CAAmB,EAA3B,EAA+B,UAAU,IAAzC,EAA+C,cAAc,IAA7D,EAlB+B;AAmBxC,aAAY,EAAE,MAAM,aAAa,KAAb,CAAmB,EAA3B,EAA+B,UAAU,IAAzC,EAA+C,cAAc,IAA7D;AAnB4B,CAAjB,CAAxB,EAoBI,EAAC,WAAU,IAAX,EApBJ;;AAsBA,IAAI,OAAO,QAAX,EAAqB;AACnB,QAAO,OAAP,CAAe,YAAf,EAA6B,YAAW;AACvC,SAAO,WAAW,IAAX,EAAP;AACA,EAFD;AAGD,0H;;;;;;;;;;;AC7BD,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,QAAQ,IAAI,MAAM,UAAV,CAAqB,OAArB,EAA8B,EAAC,cAAc,OAAf,EAA9B,CAAd;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,OAAf,EAAwB,YAAW;AAClC,WAAO,MAAM,IAAN,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;AACA,OAAO,IAAM,aAAa,IAAI,MAAM,UAAV,CAAqB,YAArB,EAAmC,EAAC,cAAc,OAAf,EAAnC,CAAnB,oC;;;;;;;;;;;ACDP,SAAS,KAAT,QAAsB,cAAtB;AACA,OAAO,IAAM,UAAU,IAAI,MAAM,UAAV,CAAqB,SAArB,EAAgC,EAAC,cAAc,OAAf,EAAhC,CAAhB;AACP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,SAAf,EAA0B,YAAW;AACpC,WAAO,QAAQ,IAAR,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACND,SAAS,KAAT,QAAsB,cAAtB;;AAEA,OAAO,IAAM,YAAY,IAAI,MAAM,UAAV,CAAqB,WAArB,EAAkC,EAAC,cAAc,OAAf,EAAlC,CAAlB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,WAAf,EAA4B,YAAW;AACtC,WAAO,UAAU,IAAV,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;ACRD,SAAS,KAAT,QAAsB,cAAtB;;;;AAIA,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,OAAf,EAAwB,YAAW;AAClC,WAAO,OAAO,KAAP,CAAa,IAAb,EAAP;AACA,GAFD;AAGD,yH;;;;;;;;;;;;ACRD,SAAS,OAAT,EAAkB,UAAlB,EAA8B,KAA9B,QAA2C,QAA3C;AACA,SAAS,SAAT,QAA0B,iBAA1B;AACA,SAAS,SAAT,QAA0B,WAA1B;;AAEA,WAAa,eAAb;AAAA,kBACS,SADT,sBACmB,OADnB,EAC4B,IAD5B,EACkC,MADlC,EAC0C,GAD1C,EAC+C;AAC3C,QAAI,YAAY,IAAI,aAAJ,CAAkB,MAAlB,EAA0B,IAA1B,KAAmC,EAAnD,C;;AAEA,QAAI,QAAQ,UAAU,MAAV,EAAkB,IAAlB,CAAZ;AACA,QAAI,SAAS,SAAS,UAAU,QAAV,IAAsB,CAA/B,CAAb;AACA,QAAI,QAAQ,WAAW,UAAU,UAAV,IAAwB,CAAnC,IAAwC,MAAxC,IAAkD,UAAU,OAAV,IAAqB,CAAvE,CAAZ;;AAEA,WAAO;AACL,eAAS,OADJ;AAEL,kBAAY,UAAU,UAFjB;AAGL,aAAO,KAHF;AAIL,gBAAU,UAAU,QAAV,IAAsB,CAJ3B;AAKL,cAAQ,MALH;AAML,eAAS,UAAU,OAAV,IAAqB,CANzB;AAOL,aAAO;AAPF,KAAP;AASD,GAjBH;;AAmBE,2BAAY,MAAZ,EAAoB;AAAA;;AAClB,SAAK,KAAL,GAAa,WAAW,IAAI,IAAJ,EAAX,CAAb;AACA,SAAK,SAAL,GAAiB,YAAjB;AACA,SAAK,MAAL,GAAc,MAAd;AACA,SAAK,UAAL,GAAkB,EAAlB;AACA,SAAK,eAAL,GAAuB,EAAvB;AACA,SAAK,MAAL,GAAc,EAAd;AACD;;AA1BH,4BA4BE,YA5BF,yBA4Be,IA5Bf,EA4BqB;AACjB,WAAO,KAAK,UAAL,CAAgB,IAAhB,CAAP;AACD,GA9BH;;AAAA,4BAgCE,SAhCF,sBAgCY,IAhCZ,EAgCkB,CAEf,CAlCH;;AAAA,4BAoCE,aApCF,0BAoCgB,IApChB,EAoCsB;AAClB,QAAI,CAAC,KAAK,eAAL,CAAqB,IAArB,CAAL,EAAiC;AAC/B,WAAK,eAAL,CAAqB,IAArB,IAA6B,UAAU,OAAV,CAAkB,EAAC,MAAK,KAAK,MAAX,EAAmB,MAAK,IAAxB,EAAlB,CAA7B;AACD;AACD,WAAO,KAAK,eAAL,CAAqB,IAArB,CAAP;AACD,GAzCH;;AAAA,4BA2CE,OA3CF,oBA2CU,IA3CV,EA2CgB;AACZ,WAAO,OAAO,IAAP,IAAe,QAAf,GAA0B,IAA1B,GAAiC,WAAW,IAAX,CAAxC;;AAEA,QAAI,CAAC,KAAK,MAAL,CAAY,IAAZ,CAAL,EAAwB;AACtB,WAAK,MAAL,CAAY,IAAZ,IAAoB,KAAK,QAAL,CAAc,IAAd,CAApB;AACD;;AAED,WAAO,KAAK,MAAL,CAAY,IAAZ,CAAP;AACD,GAnDH;;AAAA,4BAqDE,QArDF,qBAqDW,IArDX,EAqDiB;AAAA;;AACb,QAAI,OAAO,WAAW,OAAX,CAAX,EAAgC;AAC9B,aAAO,KAAK,aAAL,CAAmB,IAAnB,CAAP;AACD;AACD,QAAI,YAAY,WAAW,OAAX,CAAhB;AACA,QAAI,cAAc,SAAlB;AACA,QAAI,QAAJ;AACA,WAAO,eAAe,IAAtB,EAA4B;AAC1B,UAAI,CAAC,KAAK,UAAL,CAAgB,WAAhB,CAAL,EAAmC;AACjC,YAAI,YAAY,KAAK,aAAL,CAAmB,WAAnB,KAAmC,EAAnD;AACA,YAAI,UAAU,eAAe,SAAf,GAA2B,UAAU,OAArC,GAAgD,KAAK,UAAL,CAAgB,QAAhB,EAA0B,KAA1B,IAAmC,CAAjG;AACA,aAAK,UAAL,CAAgB,WAAhB,IAA+B,gBAAgB,SAAhB,CAA0B,OAA1B,EAAmC,WAAnC,EAAgD,KAAK,MAArD,EAA6D;AAC1F,yBAAe,uBAAC,MAAD,EAAS,IAAT,EAAkB;AAAC,mBAAO,MAAK,aAAL,CAAmB,IAAnB,CAAP;AAAgC;AADwB,SAA7D,CAA/B;AAGD;AACD,iBAAW,WAAX;AACA,oBAAc,WAAW,QAAQ,WAAR,EAAqB,CAArB,CAAX,CAAd;AACD;AACD,WAAO,KAAK,UAAL,CAAgB,IAAhB,CAAP;AACD,GAxEH;;AAAA;AAAA,yH;;;;;;;;;;;ACJA;IACE,IAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;IACrB,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;AACrE,CAAC;AAHe,aAAK,QAGpB;AAED,mBAA0B,IAAI,EAAE,KAAK,EAAE,GAAG;IACxC,MAAM,CAAC,IAAI,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAC7C,CAAC;AAFe,iBAAS,YAExB;AACD,iBAAwB,IAAI,EAAE,IAAI;IAChC,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC;IAC3B,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;AAC/E,CAAC;AAHe,eAAO,UAGtB;AACD,yBAAgC,KAAK;IACnC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC;AAC7D,CAAC;AAFe,uBAAe,kBAE9B;AACD,8BAAqC,KAAK,EAAE,MAAW;IAAX,sBAAW,GAAX,aAAW;IACrD,IAAI,IAAI,GAAG,EAAE,CAAC;IACd,IAAI,QAAQ,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC;IACtC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QACX,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC,EAAE,CAAC;YACtD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC;IACH,CAAC;IACD,IAAI,GAAG,GAAG,QAAQ,CAAC;IACnB,OAAO,GAAG,CAAC,QAAQ,EAAE,IAAI,KAAK,CAAC,QAAQ,EAAE,IAAI,GAAG,CAAC,QAAQ,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,MAAM,EAAE,CAAC;QAC5G,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACf,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACxB,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AACd,CAAC;AAde,4BAAoB,uBAcnC;AAED,uBAA8B,IAAiB;IAC7C,EAAE,CAAC,CAAC,OAAO,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC;QAC5B,MAAM,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAS,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;IACvD,CAAC;IACD,IAAI,CAAC,CAAC;QACJ,MAAM,CAAO,IAAI,CAAC;IACpB,CAAC;AACH,CAAC;AAPe,qBAAa,gBAO5B;AAED,oBAA2B,IAAI;IAC7B,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;QACT,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;IACvH,CAAC;AACH,CAAC;AAJe,kBAAU,aAIzB;AAED,uBAA8B,KAAW;IACvC,IAAI,IAAI,GAAG,oBAAoB,CAAC,KAAK,CAAC,CAAC;IACvC,IAAI,KAAK,GAAG,EAAE,CAAC;IACf,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,GAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QACvC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACvC,CAAC;IACD,MAAM,CAAC,KAAK,CAAC;AACf,CAAC;AAPe,qBAAa,gBAO5B;;;;;;;;;;;;ACrDD,IAAI,MAAJ;;AAEA,SAAS,MAAT,QAAuB,cAAvB;;AAEA,OAAO,SAAS,UAAT,CAAoB,IAApB,EAA0B;AAChC,MAAI,IAAJ,EAAU;AACT,WAAO,KAAK,WAAL,KAAqB,GAArB,GAA2B,EAAE,QAAF,CAAW,KAAK,QAAL,KAAkB,CAA7B,EAAgC,CAAhC,EAAmC,GAAnC,CAA3B,GAAqE,GAArE,GAA2E,EAAE,QAAF,CAAW,KAAK,OAAL,EAAX,EAA2B,CAA3B,EAA8B,GAA9B,CAAlF;AACA;AACD;;AAED,OAAO,SAAS,IAAT,CAAc,IAAd,EAAuC;AAAA,MAAnB,YAAmB,yDAAN,IAAM;;AAC5C,MAAI,OAAO,IAAI,IAAJ,CAAS,KAAK,KAAL,CAAW,WAAW,IAAtB,CAAT,CAAX;AACA,MAAI,QAAQ,KAAK,QAAL,EAAZ;AACA,MAAI,SAAS,SAAS,EAAT,GAAc,IAAd,GAAmB,IAAhC;AACA,UAAS,CAAC,QAAQ,EAAT,IAAe,EAAf,GAAoB,CAA7B;;AAEA,SAAO,SAAS,eAAe,KAAK,MAApB,GAA6B,EAAtC,CAAP;AACD;;AAED,OAAO,SAAS,WAAT,CAAqB,IAArB,EAA2B;AACjC,MAAI,IAAJ,EAAU;AACR,WAAO,KAAK,KAAK,KAAV,EAAiB,KAAjB,IAA0B,GAA1B,GAAgC,KAAK,KAAK,GAAV,CAAvC;AACD;AACD;;AAED,OAAO,SAAS,SAAT,CAAmB,MAAnB,EAA2B,IAA3B,EAAiC;AACtC,MAAI,SAAS,OAAO,IAAP,CAAY,EAAC,wBAAuB,IAAxB,EAA8B,OAAM,WAApC,EAAiD,SAAQ,EAAC,YAAW,EAAC,gBAAe,EAAC,YAAW,EAAC,YAAW,MAAZ,EAAZ,EAAhB,EAAZ,EAAzD,EAAZ,EAAsI,KAAtI,EAAb;AACA,MAAI,QAAQ,CAAZ;AACA,uBAAkB,MAAlB,kHAA0B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAjB,KAAiB;;AACzB,0BAAmB,MAAM,OAAzB,yHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,UAAzB,MAAyB;;AACjC,4BAA0B,OAAO,cAAjC,yHAAiD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,YAAxC,aAAwC;;AAChD,YAAI,cAAc,IAAd,CAAmB,GAAnB,CAAuB,IAAvB,IAA+B,OAAO,IAA1C,EAAgD;AAC/C,mBAAS,cAAc,QAAvB;AACA;AACA;AACD;AACD;AACD;AACD,SAAO,KAAP;AACD;;AAGD,OAAO,SAAS,SAAT,CAAmB,KAAnB,EAA0B;AAC/B,UAAQ,QAAQ,CAAhB;AACE,SAAK,CAAL;AAAQ,aAAO,SAAP;AACR,SAAK,CAAL;AAAQ,aAAO,UAAP;AACR,SAAK,CAAL;AAAQ,aAAO,OAAP;AACR,SAAK,CAAL;AAAQ,aAAO,OAAP;AACR,SAAK,CAAL;AAAQ,aAAO,KAAP;AACR,SAAK,CAAL;AAAQ,aAAO,MAAP;AACR,SAAK,CAAL;AAAQ,aAAO,MAAP;AACR,SAAK,CAAL;AAAQ,aAAO,QAAP;AACR,SAAK,CAAL;AAAQ,aAAO,WAAP;AACR,SAAK,EAAL;AAAS,aAAO,SAAP;AACT,SAAK,EAAL;AAAS,aAAO,UAAP;AACT,SAAK,EAAL;AAAS,aAAO,UAAP;AAZX;AAcD,0H;;;;;;;;;;;ACzDD,SAAS,MAAT,QAAuB,eAAvB;AACA,OAAO,sBAAP;AACA,SAAS,UAAT,EAAqB,SAArB,QAAsC,oBAAtC;AACA,SAAS,OAAT,EAAkB,KAAlB,QAA+B,iBAA/B;AACA,SAAS,eAAT,QAAgC,4BAAhC;AACA,SAAS,IAAT,QAAqB,aAArB;AACA,SAAS,MAAT,QAAuB,uBAAvB;AACA,SAAS,QAAT,QAAyB,yBAAzB;AACA,SAAS,SAAT,QAA0B,0BAA1B;AACA,SAAS,WAAT,QAA4B,4BAA5B;AACA,SAAS,KAAT,QAAsB,sBAAtB;AACA,SAAS,WAAT,QAA4B,4BAA5B;AACA,SAAS,SAAT,QAA0B,0BAA1B;AACA,SAAS,MAAT,QAAuB,uBAAvB;AACA,SAAS,kBAAT,QAAmC,mCAAnC;AACA,SAAS,mBAAT,QAAoC,oCAApC;AACA,SAAS,UAAT,QAA2B,2BAA3B;AACA,SAAS,SAAT,QAA0B,0BAA1B;AACA,SAAS,KAAT,QAAsB,sBAAtB;AACA,SAAS,OAAT,QAAwB,wBAAxB;AACA,SAAS,MAAT,QAAuB,uBAAvB;AACA,SAAS,QAAT,QAAyB,yBAAzB;AACA,SAAS,eAAT,QAAgC,gCAAhC;AACA,SAAS,OAAT,QAAwB,wBAAxB;AACA,SAAS,UAAT,QAA2B,2BAA3B;;AAEA,IAAI,MAAJ;;AAEA,IAAI,MAAM,IAAI,QAAJ,CAAa;;;;;AAAA,CAAb,CAAV;;;;;;;;;AAcA,IAAI,QAAJ,CAAa,yBAAb,EAAwC;AACvC,MAAK,eAAW;AACf,UAAQ,GAAR,CAAY,KAAK,WAAjB;AACE,MAAI,SAAS,KAAK,WAAL,CAAiB,MAA9B;AACA,MAAI,QAAQ,EAAZ;AACA,MAAI,MAAJ,EAAY;AACV,OAAI,YAAY,UAAU,IAAV,CAAe,EAAC,MAAK,IAAI,MAAJ,CAAW,MAAX,EAAmB,GAAnB,CAAN,EAAf,EAA+C,KAA/C,GAAuD,GAAvD,CAA2D;AAAA,WAAY,SAAS,GAArB;AAAA,IAA3D,CAAhB;AACA,OAAI,WAAW,SAAS,IAAT,CAAc,EAAC,MAAK,IAAI,MAAJ,CAAW,MAAX,EAAmB,GAAnB,CAAN,EAAd,EAA8C,KAA9C,GAAsD,GAAtD,CAA0D;AAAA,WAAW,QAAQ,GAAnB;AAAA,IAA1D,CAAf;AACA,SAAM,GAAN,GAAY,CAAC,EAAC,MAAK,IAAI,MAAJ,CAAW,MAAX,EAAmB,GAAnB,CAAN,EAAD,EAAiC,EAAC,KAAI,IAAI,MAAJ,CAAW,MAAX,EAAmB,GAAnB,CAAL,EAAjC,EAAgE,EAAC,UAAS,EAAC,KAAI,SAAL,EAAV,EAAhE,EAA4F,EAAC,SAAQ,EAAC,KAAI,QAAL,EAAT,EAA5F,CAAZ;AACD;AACD,MAAI,QAAQ,MAAM,IAAN,CAAW,KAAX,EAAkB,KAAlB,EAAZ;AACA,MAAI,OAAO,EAAX;AACA,uBAAiB,KAAjB,kHAAwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAf,IAAe;;AACvB,OAAI,kBAAkB,IAAI,eAAJ,CAAoB,KAAK,GAAzB,CAAtB;AACA,OAAI,SAAS,gBAAgB,OAAhB,CAAwB,KAAK,WAAL,CAAiB,IAAzC,CAAb;AACA,QAAK,IAAL,CAAU;AACT,oBAAgB,KAAK,IADZ;AAET,iBAAa,UAAU,OAAV,CAAkB,KAAK,QAAvB,EAAiC,IAFrC;AAGT,eAAW,SAAS,OAAT,CAAiB,KAAK,OAAtB,EAA+B,IAHjC;AAIT,WAAO,KAAK,GAJH;AAKT,eAAW,OAAO,OALT;AAMT,aAAS,OAAO,KANP;AAOT,iBAAa,OAAO,QAPX;AAQT,cAAU,OAAO,MARR;AAST,eAAW,OAAO,OATT;AAUT,aAAS,OAAO;AAVP,IAAV;AAYA;AACD,OAAK,QAAL,CAAc,SAAd,CAAwB,cAAxB,EAAwC,UAAxC;AACA,OAAK,QAAL,CAAc,SAAd,CAAwB,qBAAxB,EAA+C,2CAA2C,KAAK,WAAL,CAAiB,IAA5D,GAAmE,MAAlH;AACD,OAAK,QAAL,CAAc,KAAd,CAAoB,MAAM,EAAE,IAAF,CAAO,KAAK,CAAL,KAAW,EAAlB,EAAsB,IAAtB,CAA2B,KAA3B,CAAN,GAA0C,KAA9D;AACA,wBAAgB,IAAhB,yHAAsB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAb,GAAa;;AACrB,QAAK,QAAL,CAAc,KAAd,CAAoB,MAAM,EAAE,MAAF,CAAS,GAAT,EAAc,IAAd,CAAmB,KAAnB,CAAN,GAAkC,KAAtD;AACA;AACA,OAAK,IAAL;AACF;AAnCsC,CAAxC;;AAsCA,IAAI,QAAJ,CAAa,oBAAb,EAAmC;AAClC,MAAK,eAAW;AACf,MAAI,aAAa,UAAU,IAAV,CAAe,EAAC,MAAK,YAAN,EAAoB,SAAQ,IAA5B,EAAf,EAAkD,KAAlD,EAAjB;AACA,wBAAsB,UAAtB,yHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAzB,SAAyB;;AACjC,aAAU,MAAV,CAAiB,UAAU,GAA3B,EAAgC,EAAC,MAAK,EAAC,SAAQ,UAAU,KAAnB,EAAN,EAAhC;AACA;AACD;AANiC,CAAnC;;AASA,SAAS,WAAT,GAAuB;AACtB,KAAI,SAAS,WAAW,OAAX,CAAb;AACA,KAAI,YAAY,WAAW,QAAQ,OAAR,EAAiB,CAAC,CAAlB,CAAX,CAAhB;AACA,KAAI,QAAQ,MAAM,IAAN,GAAa,KAAb,EAAZ;AACA,uBAAiB,KAAjB,yHAAwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,MAAf,IAAe;;;AAEvB,MAAI,kBAAkB,UAAU,OAAV,CAAkB,EAAC,MAAK,SAAN,EAAiB,MAAK,KAAK,GAA3B,EAAlB,CAAtB;AACA,MAAI,SAAS,gBAAgB,SAAhB,CAA0B,gBAAgB,OAA1C,EAAmD,SAAnD,EAA8D,KAAK,GAAnE,EAAwE;AACpF,gBADoF,yBACtE,MADsE,EAC9D,IAD8D,EACxD;AAC3B,WAAO,UAAU,OAAV,CAAkB,EAAC,MAAK,MAAN,EAAc,MAAK,IAAnB,EAAlB,CAAP;AACA;AAHmF,GAAxE,CAAb;;;AAOA,YAAU,MAAV,CAAiB,gBAAgB,GAAjC,EAAsC,EAAC,MAAK,MAAN,EAAtC;;AAEA,MAAI,CAAC,UAAU,OAAV,CAAkB,EAAC,MAAK,MAAN,EAAc,MAAK,KAAK,GAAxB,EAAlB,CAAL,EAAsD;AACrD,aAAU,MAAV,CAAiB,EAAE,MAAF,CAAS,EAAC,MAAK,MAAN,EAAc,MAAK,KAAK,GAAxB,EAAT,EAAuC,EAAC,SAAQ,OAAO,KAAhB,EAAvC,CAAjB;AACA,GAFD,MAGK;AACJ,aAAU,MAAV,CAAiB,EAAC,MAAK,MAAN,EAAc,MAAK,KAAK,GAAxB,EAAjB,EAA+C,EAAC,MAAK,EAAC,SAAQ,OAAO,KAAhB,EAAN,EAA/C;AACA;AACD;AACD;;AAED,IAAI,QAAJ,CAAa,cAAb,EAA6B;AAC5B,MAAK,eAAW;AACf;AACA,SAAO,EAAP;AACA;AAJ2B,CAA7B;;AAOA,IAAI,QAAJ,CAAa,sBAAb,EAAqC;AACpC,MAAK,eAAW;AACf,MAAI,QAAQ,MAAM,IAAN,GAAa,KAAb,EAAZ;AACA,MAAI,YAAY,YAAhB;AACA,wBAAiB,KAAjB,yHAAwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAf,IAAe;;AACvB,OAAI,OAAO,SAAX;AACA,OAAI,WAAW,WAAW,OAAX,CAAf;AACA,OAAI,QAAJ,EAAc,UAAd;AACA,MAAG;AACF,QAAI,SAAS,gBAAgB,SAAhB,CAA0B,QAAQ,SAAR,GAAoB,CAAC,UAAU,OAAV,CAAkB,EAAC,MAAK,KAAK,GAAX,EAAgB,MAAK,IAArB,EAAlB,KAAiD,EAAC,SAAQ,CAAT,EAAlD,EAA+D,OAAnF,GAA6F,WAAW,KAAlI,EAAyI,IAAzI,EAA+I,KAAK,GAApJ,EAAyJ;AACrK,kBADqK,yBACvJ,MADuJ,EAC/I,IAD+I,EACzI;AAC3B,aAAO,UAAU,OAAV,CAAkB,EAAC,MAAK,MAAN,EAAc,MAAK,IAAnB,EAAlB,CAAP;AACA;AAHoK,KAAzJ,CAAb;AAKA,QAAI,CAAC,UAAU,OAAV,CAAkB,EAAC,MAAK,IAAN,EAAY,MAAK,KAAK,GAAtB,EAAlB,CAAL,EAAoD;AACnD,eAAU,MAAV,CAAiB,EAAE,MAAF,CAAS,EAAC,MAAK,IAAN,EAAY,MAAK,KAAK,GAAtB,EAAT,EAAqC,MAArC,CAAjB;AACA,KAFD,MAGK;AACJ,eAAU,MAAV,CAAiB,EAAC,MAAK,IAAN,EAAY,MAAK,KAAK,GAAtB,EAAjB,EAA6C,EAAC,MAAK,MAAN,EAA7C;AACA;AACD,eAAW,IAAX;AACA,iBAAa,MAAb;AACA,WAAO,WAAW,QAAQ,IAAR,EAAc,CAAd,CAAX,CAAP;AACA,IAfD,QAeS,QAAQ,QAfjB;AAgBA;AACD,SAAO,EAAP;AACA;AA1BmC,CAArC;;AA6BA,IAAI,QAAJ,CAAa,OAAb,EAAsB;AACrB,MAAK,eAAW;AACf,MAAI,QAAQ,MAAM,IAAN,GAAa,KAAb,EAAZ;AACA,MAAI,YAAY,QAAQ,OAAR,EAAiB,CAAC,CAAlB,CAAhB;AACA,MAAI,aAAa,WAAW,OAAX,CAAmB,EAAnB,CAAjB;AACA,MAAI,eAAJ;AACA,MAAI,CAAC,UAAD,IAAe,WAAW,SAAX,CAAqB,OAArB,MAAkC,UAAU,OAAV,EAArD,EAA0E;AACzE,qBAAkB,EAAlB;AACA,yBAAiB,KAAjB,yHAAwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,QAAf,IAAe;;AACvB,QAAI,kBAAkB,IAAI,eAAJ,CAAoB,KAAK,GAAzB,CAAtB;AACA,oBAAgB,KAAK,GAAL,CAAS,IAAzB,IAAiC,CAAC,gBAAgB,OAAhB,CAAwB,SAAxB,KAAsC,EAAC,OAAM,CAAP,EAAvC,EAAkD,KAAnF;AACA;AACD,OAAI,UAAJ,EAAgB;AACf,eAAW,MAAX,CAAkB,EAAC,KAAI,WAAW,GAAhB,EAAlB,EAAwC,EAAC,MAAK,EAAC,WAAU,SAAX,EAAsB,OAAM,eAA5B,EAAN,EAAxC;AACA,IAFD,MAGK;AACJ,eAAW,MAAX,CAAkB,EAAC,WAAU,SAAX,EAAsB,OAAM,eAA5B,EAAlB;AACA;AACD,GAZD,MAaK;AACJ,qBAAkB,WAAW,KAA7B;AACA;AACD,MAAI,QAAQ,EAAZ;AACA,wBAAiB,KAAjB,yHAAwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,OAAf,KAAe;;AACvB,SAAM,MAAK,GAAL,CAAS,IAAf,IAAuB,gBAAgB,SAAhB,CAA0B,gBAAgB,MAAK,GAAL,CAAS,IAAzB,CAA1B,EAA0D,WAAW,OAAX,CAA1D,EAA+E,MAAK,GAApF,EAAyF;AAC/G,iBAD+G,yBACjG,MADiG,EACzF,IADyF,EACnF;AAC3B,YAAO,UAAU,OAAV,CAAkB,EAAC,MAAK,MAAN,EAAc,MAAK,IAAnB,EAAlB,CAAP;AACA;AAH8G,IAAzF,EAIpB,KAJH;AAKA;AACD,SAAO,KAAP;AACA;AA/BoB,CAAtB;;AAkCA,SAAS,YAAT,CAAsB,IAAtB,EAA4B;AAC3B,KAAI,cAAc,WAAW,QAAQ,IAAR,EAAc,CAAC,CAAf,CAAX,CAAlB;;AAEA,KAAI,aAAa,UAAU,IAAV,CAAe,EAAC,MAAK,WAAN,EAAf,EAAmC,KAAnC,EAAjB;;AAEA,uBAAsB,UAAtB,yHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,MAAzB,SAAyB;;AACjC,MAAI,QAAQ,UAAU,UAAU,IAApB,EAA0B,WAA1B,CAAZ;AACA,MAAI,SAAS,SAAS,UAAU,QAAV,IAAsB,CAA/B,CAAb;AACA,MAAI,QAAS,UAAU,KAAV,GAAkB,MAAnB,IAA8B,UAAU,OAAV,IAAqB,CAAnD,CAAZ;AACA,YAAU,MAAV,CAAiB;AAChB,SAAM,UAAU,IADA;AAEhB,SAAM,WAAW,IAAX;AAFU,GAAjB,EAGG,EAAC,MAAK;AACR,WAAO;AADC,IAAN,EAHH,EAKI,EAAC,QAAQ,IAAT,EALJ;AAMA;AACD;;AAED,OAAO,OAAP,CAAe,YAAM,CACpB,CADD;;AAGA,WAAW,GAAX,CAAe;AACd,OAAM,uBADQ;AAEd,SAFc,oBAEL,MAFK,EAEG;AAChB,SAAO,OAAO,IAAP,CAAY,aAAZ,CAAP;AACA,EAJa;AAKd,IALc,iBAKR;AACL;AACA;AAPa,CAAf;AASA,WAAW,KAAX;;AAEA,OAAO,OAAP,CAAe;AACd,YADc,uBACF,IADE,EACI;AACjB,MAAI,SAAS,KAAK,IAAL,CAAU,OAAO,QAAP,WAAuB,cAAvB,GAAwC,mBAAxC,IAA+D,KAAK,IAAL,IAAa,QAA5E,CAAV,EAAiG;AAC7G,YAAQ,KAAK;AADgG,GAAjG,CAAb;AAGA,UAAQ,GAAR,CAAY,MAAZ;AACA,MAAI,OAAO,IAAP,CAAY,MAAZ,IAAsB,SAA1B,EAAqC;AACpC,UAAO,OAAO,IAAd;;AAEA;AACD,EAVa;AAWd,gBAXc,6BAWI;AACjB,aAAW,MAAX,CAAkB,EAAlB;AACA,EAba;AAcd,uBAdc,kCAcS,MAdT,EAciB;AAC9B,WAAS,sBAAT,CAAgC,MAAhC;AACA;AAhBa,CAAf,0H","file":"/app.js","sourcesContent":["import { Mongo } from 'meteor/mongo';\n \nexport const AddOns = new Mongo.Collection('addOns', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('addOns', function() {\n  \treturn AddOns.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const AnomalyTriggers = new Mongo.Collection('anomalyTriggers', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('anomalyTriggers', function() {\n    return AnomalyTriggers.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Blocks = new Mongo.Collection('blocks', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('blocks', function() {\n  \treturn Blocks.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const BundleTypes = new Mongo.Collection('bundleTypes', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('bundleTypes', function() {\n  \treturn BundleTypes.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Deleted = new Mongo.Collection('deleted', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('deleted', function() {\n  \treturn Deleted.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const FulfillmentSettings = new Mongo.Collection('fulfillmentSettings', {idGeneration: 'MONGO'});\nFulfillmentSettings.attachSchema(new SimpleSchema({\n\tdeliveryFee: { type: Number, decimal: true },\n\t'timestamps.deliveryFee': { type: Date, optional: true },\n\n\tfreeDeliveryThreshold: { type: Number },\n\t'timestamps.freeDeliveryThreshold': { type: Date, optional: true },\n\n\tminDays: { type: Number },\n\t'timestamps.minDays': { type: Date, optional: true },\n\t\n\tcutoffTime: { type: Number },\n\t'timestamps.cutoffTime': { type: Date, optional: true },\n}), {transform:true});\n\nif (Meteor.isServer) {\n  Meteor.publish('fulfillmentSettings', () => {\n  \treturn FulfillmentSettings.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Ingredients = new Mongo.Collection('ingredients', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('ingredients', function() {\n  \treturn Ingredients.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const LocationSurcharges = new Mongo.Collection('locationSurcharges', {idGeneration: 'MONGO'});\nLocationSurcharges.attachSchema(new SimpleSchema({\n\tsurcharge: { type: Number, decimal: true },\n\tpostalPrefix: { type: String }\n}), {transform:true});\n\nif (Meteor.isServer) {\n  Meteor.publish('locationSurcharges', function() {\n  \treturn LocationSurcharges.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const MealPlans = new Mongo.Collection('mealPlans', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('mealPlans', function() {\n  \treturn MealPlans.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\nimport { formatDate } from '../helpers';\n \nexport const MealStock = new Mongo.Collection('mealStock', {idGeneration: 'MONGO'});\nMealStock.attachSchema(new SimpleSchema({\n\tinitial: { type: Number, optional: true },\n\tadjustment: { type: Number, optional: true },\n\trestock: { type: Number, optional: true },\n\toutput: { type: Number, optional: true },\n\tsales: { type: Number, optional: true },\n\tnonSales: { type: Number, optional: true },\n\tstock: { type: Number, optional: true },\n\t\n\tlastUpdated: { type: Object, optional: true, blackbox: true },\n\tmeal: { type: Mongo.ObjectID },\n\tdate: { type: String },\n}), {transform:true});\n\nif (Meteor.isServer) {\n  Meteor.publish('mealStock', function() {\n  \treturn MealStock.find();\n  });\n\n  Meteor.publish('mealStockForDates', function(minDate, maxDate) {\n  \treturn MealStock.find({date:{$gte:formatDate(minDate), $lte:formatDate(maxDate)}});\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Meals = new Mongo.Collection('meals', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('meals', function() {\n  \treturn Meals.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Orders = new Mongo.Collection('orders', {idGeneration: 'MONGO'});\nimport { formatDate } from '../helpers';\n\nif (Meteor.isServer) {\n  Meteor.publish('orders', function() {\n  \treturn Orders.find();\n  });\n\n  Meteor.publish('ordersByDate', function(minDate, maxDate) {\n  \treturn Orders.find({'deliveryOptions.date':{$gte:formatDate(minDate), $lt:formatDate(maxDate)}});\n  });\n\n  Meteor.publish('orderById', function(id) {\n  \treturn Orders.find(id);\n  });\n\n  Meteor.publish('futureOrders', function(id) {\n  \treturn Orders.find({'deliveryOptions.date':{$gte:formatDate(new Date)}});\n  });\n}\n","import { Mongo } from 'meteor/mongo';\nexport const Partners = new Mongo.Collection('partners', {idGeneration: 'MONGO'});\nif (Meteor.isServer) {\n  Meteor.publish('partners', function() {\n  \treturn Partners.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Portions = new Mongo.Collection('portions', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('portions', function() {\n  \treturn Portions.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Promotions = new Mongo.Collection('promotions', {idGeneration: 'MONGO'});\nPromotions.attachSchema(new SimpleSchema({\n\tname: {type: String },\n\tdeliveryFee: { type: Boolean, defaultValue: false },\n\tstart: { type: String },\n\tend: { type: String },\n\tfulfillmentStart: { type: String, optional: true },\n\tfulfillmentEnd: { type: String, optional: true },\n\tdiscount: { type: Number, optional: true },\n\toverridePrice: { type: Number, optional: true, decimal: true },\n\ttype: { type: String },\n\tpromoCode: { type: String },\n\tsku: { type: String },\n\tusageLimit: { type: Number, optional: true },\n\n\tpremiumAllowance: { type: Number, optional: true },\n\tpremiumCap: { type: Number, optional: true },\n\n\tmealPlan: { type: SimpleSchema.RegEx.Id, optional: true, defaultValue: null },\n\tportion: { type: SimpleSchema.RegEx.Id, optional: true, defaultValue: null },\n\tbundleType: { type: SimpleSchema.RegEx.Id, optional: true, defaultValue: null }\n}), {transform:true});\n\nif (Meteor.isServer) {\n  Meteor.publish('promotions', function() {\n  \treturn Promotions.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const Sides = new Mongo.Collection('sides', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('sides', function() {\n  \treturn Sides.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\nexport const StockCache = new Mongo.Collection('stockCache', {idGeneration: 'MONGO'});\n","import { Mongo } from 'meteor/mongo';\nexport const Surveys = new Mongo.Collection('surveys', {idGeneration: 'MONGO'});\nif (Meteor.isServer) {\n  Meteor.publish('surveys', function() {\n  \treturn Surveys.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \nexport const TimeSlots = new Mongo.Collection('timeSlots', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('timeSlots', function() {\n  \treturn TimeSlots.find();\n  });\n}\n","import { Mongo } from 'meteor/mongo';\n \n// export const Users = new Mongo.Collection('users', {idGeneration: 'MONGO'});\n\nif (Meteor.isServer) {\n  Meteor.publish('users', function() {\n  \treturn Meteor.users.find();\n  });\n}\n","import { addDays, formatDate, today } from './date';\nimport { MealStock } from './api/mealStock';\nimport { mealSales } from './helpers';\n\nexport class StockCalculator {\n  static calculate(initial, date, mealId, api) {\n    var mealStock = api.findMealStock(mealId, date) || {};//MealStock.findOne({meal:mealId, date:date}) || {};\n\n    var sales = mealSales(mealId, date);\n    var output = sales + (mealStock.nonSales || 0);\n    var stock = initial + (mealStock.adjustment || 0) - output + (mealStock.restock || 0);\n\n    return {\n      initial: initial,\n      adjustment: mealStock.adjustment,\n      sales: sales,\n      nonSales: mealStock.nonSales || 0,\n      output: output,\n      restock: mealStock.restock || 0,\n      stock: stock\n    };\n  }\n\n  constructor(mealId) {\n    this.today = formatDate(new Date());\n    this.firstDate = '2016-08-29';\n    this.mealId = mealId;\n    this._calcCache = {};\n    this._mealStockCache = {};\n    this._cache = {};\n  }\n\n  cachedValues(date) {\n    return this._calcCache[date];\n  }\n\n  initCache(date) {\n\n  }\n\n  findMealStock(date) {\n    if (!this._mealStockCache[date]) {\n      this._mealStockCache[date] = MealStock.findOne({meal:this.mealId, date:date});\n    }\n    return this._mealStockCache[date];\n  }\n\n  forDate(date) {\n    date = typeof date == 'string' ? date : formatDate(date);\n\n    if (!this._cache[date]) {\n      this._cache[date] = this._forDate(date);\n    }\n\n    return this._cache[date];\n  }\n\n  _forDate(date) {\n    if (date < formatDate(today())) {\n      return this.findMealStock(date);\n    }\n    var firstDate = formatDate(today());\n    var currentDate = firstDate;\n    var prevDate;\n    while (currentDate <= date) {\n      if (!this._calcCache[currentDate]) {\n        var mealStock = this.findMealStock(currentDate) || {};\n        var initial = currentDate == firstDate ? mealStock.initial : (this._calcCache[prevDate].stock || 0);\n        this._calcCache[currentDate] = StockCalculator.calculate(initial, currentDate, this.mealId, {\n          findMealStock: (mealId, date) => {return this.findMealStock(date)}\n        });\n      }\n      prevDate = currentDate;\n      currentDate = formatDate(addDays(currentDate, 1));\n    }\n    return this._calcCache[date];\n  }\n}\n","export function today() {\n  var now = new Date();\n  return createDay(now.getFullYear(), now.getMonth(), now.getDate());\n}\n\nexport function createDay(year, month, day) {\n  return new Date(year, month, day, 0, 0, 0);\n}\nexport function addDays(date, days) {\n  date = convertToDate(date);\n  return createDay(date.getFullYear(), date.getMonth(), date.getDate() + days);\n}\nexport function firstDayOfMonth(month) {\n  return createDay(month.getFullYear(), month.getMonth(), 1);\n}\nexport function calendarDaysForMonth(month, square=true) {\n  var days = [];\n  var firstDay = firstDayOfMonth(month);\n  if (square) {\n    for (var i = 0; i < 7 - (7 - firstDay.getDay()); ++ i) {\n      days.unshift(addDays(firstDay, -(i + 1)));\n    }    \n  }\n  var day = firstDay;\n  while (day.getMonth() == month.getMonth() || day.getMonth() > month.getMonth() && days.length % 7 && square) {\n    days.push(day);\n    day = addDays(day, 1);\n  }\n  return days;\n}\n\nexport function convertToDate(date: Date|string): Date {\n  if (typeof date == 'string') {\n    return new Date(Date.parse(<string>date + ' 00:00'));\n  }\n  else {\n    return <Date>date;\n  }\n}\n\nexport function formatDate(date) {\n  if (date) {\n    return date.getFullYear() + '-' + _.padStart(date.getMonth() + 1, 2, '0') + '-' + _.padStart(date.getDate(), 2, '0');    \n  }\n}\n\nexport function weeksForMonth(month: Date):Array<Array<Date>> {\n  var days = calendarDaysForMonth(month);\n  var weeks = [];\n  for (var i = 0; i < days.length/7; ++i) {\n    weeks.push(days.slice(i*7, i*7 + 7));\n  }\n  return weeks;\n}\n","_ = lodash;\n\nimport { Orders } from './api/orders';\n\nexport function formatDate(date) {\n\tif (date) {\n\t\treturn date.getFullYear() + '-' + _.padStart(date.getMonth() + 1, 2, '0') + '-' + _.padStart(date.getDate(), 2, '0');\n\t}\n}\n\nexport function amPm(time, appendSuffix=true) {\n  var date = new Date(Date.parse('Jan 1 ' + time));\n  var hours = date.getHours();\n  var suffix = hours >= 12 ? \"pm\":\"am\";\n  hours = ((hours + 11) % 12 + 1); \n\n  return hours + (appendSuffix ? '' + suffix : '');\n}\n\nexport function timeDisplay(time) {\n\tif (time) {\n\t  return amPm(time.start, false) + '-' + amPm(time.end);\t\t\n\t}\n}\n\nexport function mealSales(mealId, date) {\n  var orders = Orders.find({'deliveryOptions.date':date, state:'completed', bundles:{$elemMatch:{mealSelections:{$elemMatch:{'meal._id':mealId}}}}}).fetch();\n  var sales = 0;\n  for (var order of orders) {\n  \tfor (var bundle of order.bundles) {\n  \t\tfor (var mealSelection of bundle.mealSelections) {\n  \t\t\tif (mealSelection.meal._id._str == mealId._str) {\n  \t\t\t\tsales += mealSelection.quantity;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t}\n  }\n  return sales;\n}\n\n\nexport function monthName(month) {\n  switch (month + 1) {\n    case 1: return 'January';\n    case 2: return 'February';\n    case 3: return 'March';\n    case 4: return 'April';\n    case 5: return 'May';\n    case 6: return 'June';\n    case 7: return 'July';\n    case 8: return 'August';\n    case 9: return 'September';\n    case 10: return 'October';\n    case 11: return 'November';\n    case 12: return 'December';\n  }\n}\n","import { Meteor } from 'meteor/meteor';\nimport '../imports/api/users';\nimport { formatDate, mealSales } from '../imports/helpers';\nimport { addDays, today } from '../imports/date';\nimport { StockCalculator } from '../imports/StockCalculator';\nimport { HTTP } from 'meteor/http';\nimport { Orders } from '../imports/api/orders';\nimport { Portions } from '../imports/api/portions';\nimport { MealPlans } from '../imports/api/mealPlans';\nimport { BundleTypes } from '../imports/api/bundleTypes';\nimport { Meals } from '../imports/api/meals';\nimport { Ingredients } from '../imports/api/ingredients';\nimport { TimeSlots } from '../imports/api/timeSlots';\nimport { Blocks } from '../imports/api/blocks';\nimport { LocationSurcharges } from '../imports/api/locationSurcharges';\nimport { FulfillmentSettings } from '../imports/api/fulfillmentSettings';\nimport { Promotions } from '../imports/api/promotions';\nimport { MealStock } from '../imports/api/mealStock';\nimport { Sides } from '../imports/api/sides';\nimport { Surveys } from '../imports/api/surveys';\nimport { AddOns } from '../imports/api/addOns';\nimport { Partners } from '../imports/api/partners';\nimport { AnomalyTriggers } from '../imports/api/anomalyTriggers';\nimport { Deleted } from '../imports/api/deleted';\nimport { StockCache } from '../imports/api/stockCache';\n\n_ = lodash;\n\nvar api = new Restivus({\n\t// useDefaultAuth: true,\n\t// auth: {\n\t// \ttoken: 'auth.apiKey'\n\t// }\n});\n\n// api.addRoute('compute-stock', {\n// \tget: function() {\n// \t\tcomputeStock(new Date(Date.parse(this.queryParams.date)));\n// \t\treturn '';\n// \t}\n// });\n\napi.addRoute('export-inventory-status', {\n\tget: function() {\n\t\tconsole.log(this.queryParams);\n    var filter = this.queryParams.filter;\n    var query = {};\n    if (filter) {\n      var mealPlans = MealPlans.find({name:new RegExp(filter, 'i')}).fetch().map(mealPlan => mealPlan._id);\n      var portions = Portions.find({name:new RegExp(filter, 'i')}).fetch().map(portion => portion._id);\n      query.$or = [{name:new RegExp(filter, 'i')}, {sku:new RegExp(filter, 'i')}, {mealPlan:{$in:mealPlans}}, {portion:{$in:portions}}];\n    }\n    var meals = Meals.find(query).fetch();\n    var rows = [];\n    for (var meal of meals) {\n    \tvar stockCalculator = new StockCalculator(meal._id);\n    \tvar values = stockCalculator.forDate(this.queryParams.date);\n    \trows.push({\n    \t\t'Product Name': meal.name,\n    \t\t'Meal Plan': MealPlans.findOne(meal.mealPlan).name,\n    \t\t'Portion': Portions.findOne(meal.portion).name,\n    \t\t'SKU': meal.sku,\n    \t\t'Initial': values.initial,\n    \t\t'Sales': values.sales,\n    \t\t'Non-sales': values.nonSales,\n    \t\t'Output': values.output,\n    \t\t'Restock': values.restock,\n    \t\t'Stock': values.stock,\n    \t});\n    }\n    this.response.setHeader('Content-type', 'text/csv');\n    this.response.setHeader('Content-Disposition', 'attachment; filename=inventory-status.' + this.queryParams.date + '.csv');\n  \tthis.response.write('\"' + _.keys(rows[0] || {}).join('\",\"') + '\"\\n');\n  \tfor (var row of rows) {\n\t  \tthis.response.write('\"' + _.values(row).join('\",\"') + '\"\\n');\n  \t}\n    this.done();\n\t}\n});\n\napi.addRoute('migrate-meal-stock', {\n\tget: function() {\n\t\tvar mealStocks = MealStock.find({date:'2016-08-29', initial:null}).fetch();\n\t\tfor (var mealStock of mealStocks) {\n\t\t\tMealStock.update(mealStock._id, {$set:{initial:mealStock.stock}});\n\t\t}\n\t}\n});\n\nfunction recordStock() {\n\tvar _today = formatDate(today());\n\tvar yesterday = formatDate(addDays(today(), -1));\n\tvar meals = Meals.find().fetch();\n\tfor (var meal of meals) {\n\t\t// console.log(meal._id._str, yesterday);\n\t\tvar yesterdaysStock = MealStock.findOne({date:yesterday, meal:meal._id});\n\t\tvar values = StockCalculator.calculate(yesterdaysStock.initial, yesterday, meal._id, {\n\t\t\tfindMealStock(mealId, date) {\n\t\t\t\treturn MealStock.findOne({meal:mealId, date:date});\n\t\t\t}\n\t\t});\n\n\t\t// console.log(values);\n\t\tMealStock.update(yesterdaysStock._id, {$set:values});\n\n\t\tif (!MealStock.findOne({date:_today, meal:meal._id})) {\n\t\t\tMealStock.insert(_.assign({date:_today, meal:meal._id}, {initial:values.stock}));\n\t\t}\n\t\telse {\n\t\t\tMealStock.update({date:_today, meal:meal._id}, {$set:{initial:values.stock}});\n\t\t}\n\t}\n}\n\napi.addRoute('record-stock', {\n\tget: function() {\n\t\trecordStock();\n\t\treturn '';\n\t}\n});\n\napi.addRoute('generate-stock-cache', {\n\tget: function() {\n\t\tvar meals = Meals.find().fetch();\n\t\tvar firstDate = '2016-08-29';\n\t\tfor (var meal of meals) {\n\t\t\tvar date = firstDate;\n\t\t\tvar lastDate = formatDate(today());\n\t\t\tvar prevDate, prevValues;\n\t\t\tdo {\n\t\t\t\tvar values = StockCalculator.calculate(date == firstDate ? (MealStock.findOne({meal:meal._id, date:date}) || {initial:0}).initial : prevValues.stock, date, meal._id, {\n\t\t\t\t\tfindMealStock(mealId, date) {\n\t\t\t\t\t\treturn MealStock.findOne({meal:mealId, date:date});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (!MealStock.findOne({date:date, meal:meal._id})) {\n\t\t\t\t\tMealStock.insert(_.assign({date:date, meal:meal._id}, values));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tMealStock.update({date:date, meal:meal._id}, {$set:values});\n\t\t\t\t}\n\t\t\t\tprevDate = date;\n\t\t\t\tprevValues = values;\n\t\t\t\tdate = formatDate(addDays(date, 1));\n\t\t\t} while (date != lastDate);\n\t\t}\n\t\treturn '';\n\t}\n});\n\napi.addRoute('stock', {\n\tget: function() {\n\t\tvar meals = Meals.find().fetch();\n\t\tvar yesterday = addDays(today(), -1);\n\t\tvar stockCache = StockCache.findOne({});\n\t\tvar yesterdaysStock;\n\t\tif (!stockCache || stockCache.timestamp.valueOf() != yesterday.valueOf()) {\n\t\t\tyesterdaysStock = {};\n\t\t\tfor (let meal of meals) {\n\t\t\t\tlet stockCalculator = new StockCalculator(meal._id);\n\t\t\t\tyesterdaysStock[meal._id._str] = (stockCalculator.forDate(yesterday) || {stock:0}).stock;\n\t\t\t}\n\t\t\tif (stockCache) {\n\t\t\t\tStockCache.update({_id:stockCache._id}, {$set:{timestamp:yesterday, stock:yesterdaysStock}});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tStockCache.insert({timestamp:yesterday, stock:yesterdaysStock});\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tyesterdaysStock = stockCache.stock;\n\t\t}\n\t\tvar stock = {};\n\t\tfor (let meal of meals) {\n\t\t\tstock[meal._id._str] = StockCalculator.calculate(yesterdaysStock[meal._id._str], formatDate(today()), meal._id, {\n\t\t\t\tfindMealStock(mealId, date) {\n\t\t\t\t\treturn MealStock.findOne({meal:mealId, date:date});\n\t\t\t\t}\n\t\t\t}).stock;\n\t\t}\n\t\treturn stock;\n\t}\n});\n\nfunction computeStock(date) {\n\tvar previousDay = formatDate(addDays(date, -1));\n\n\tvar mealStocks = MealStock.find({date:previousDay}).fetch();\n\n\tfor (var mealStock of mealStocks) {\n\t\tvar sales = mealSales(mealStock.meal, previousDay);\n\t\tvar output = sales + (mealStock.nonSales || 0);\n\t\tvar final = (mealStock.stock - output) + (mealStock.restock || 0);\n\t\tMealStock.update({\n\t\t\tmeal: mealStock.meal,\n\t\t\tdate: formatDate(date)\n\t\t}, {$set:{\n\t\t\tstock: final\n\t\t}}, {upsert: true});\n\t}\n}\n\nMeteor.startup(() => {\n});\n\nSyncedCron.add({\n\tname: 'Update stock for day.',\n\tschedule(parser) {\n\t\treturn parser.cron('0 0 */1 * *');\n\t},\n\tjob() {\n\t\trecordStock();\n\t}\n});\nSyncedCron.start();\n\nMeteor.methods({\n\tuploadImage(args) {\n\t\tvar result = HTTP.post(Meteor.settings.public.imageServerUrl + '/upload.php?type=' + (args.type || 'raster'), {\n\t\t\tcontent:args.data,\n\t\t});\n\t\tconsole.log(result);\n\t\tif (result.data.result == 'success') {\n\t\t\treturn result.data;\n\t\t\t// Meteor.users.update({_id:Meteor.userId()}, {$set:{'profile.picture':result.data.url}});\n\t\t}\n\t},\n\tclearStockCache() {\n\t\tStockCache.remove({});\n\t},\n\tsendResetPasswordEmail(userId) {\n\t\tAccounts.sendResetPasswordEmail(userId);\n\t}\n});"]}